<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
  <title>POULTRY ¬∑ INTELLIGENT DASHBOARD</title>
  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:opsz@14..32&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
    }

    body {
      background-color: #0a0a0a;
      color: #f0f0f0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    #app {
      width: 100%;
      max-width: 420px;
      height: 780px;
      background: #0f0f0f;
      border-radius: 32px;
      overflow: hidden;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(212, 175, 55, 0.2);
      display: flex;
      flex-direction: column;
      position: relative;
    }

    .glass {
      background: rgba(30, 30, 30, 0.7);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 1px solid rgba(212, 175, 55, 0.15);
      border-bottom: 1px solid rgba(212, 175, 55, 0.3);
      box-shadow: 0 8px 20px -6px rgba(0,0,0,0.6);
    }

    .header {
      padding: 18px 20px 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: transparent;
    }
    .header h1 {
      font-size: 1.6rem;
      font-weight: 500;
      letter-spacing: -0.5px;
      background: linear-gradient(135deg, #fff 0%, #d4af37 80%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .header i {
      font-size: 1.5rem;
      color: #d4af37;
      background: rgba(212, 175, 55, 0.1);
      padding: 10px;
      border-radius: 50%;
    }

    .main-content {
      flex: 1;
      overflow-y: auto;
      padding: 12px 16px 80px 16px;
      scrollbar-width: thin;
      scrollbar-color: #d4af37 #1e1e1e;
    }
    .main-content::-webkit-scrollbar {
      width: 4px;
    }
    .main-content::-webkit-scrollbar-track {
      background: #1e1e1e;
    }
    .main-content::-webkit-scrollbar-thumb {
      background: #d4af37;
      border-radius: 8px;
    }

    .bottom-nav {
      position: absolute;
      bottom: 0;
      width: 100%;
      max-width: 420px;
      display: flex;
      justify-content: space-around;
      align-items: center;
      background: rgba(10, 10, 10, 0.9);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      border-top: 1px solid rgba(212, 175, 55, 0.3);
      padding: 8px 0 14px 0;
      z-index: 10;
    }
    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      color: #888;
      font-size: 0.7rem;
      transition: all 0.15s ease;
      cursor: pointer;
      padding: 6px 12px;
      border-radius: 30px;
      background: transparent;
    }
    .nav-item i {
      font-size: 1.5rem;
      margin-bottom: 2px;
    }
    .nav-item.active {
      color: #d4af37;
      background: rgba(212, 175, 55, 0.1);
      text-shadow: 0 0 8px #d4af3740;
    }

    .card {
      background: rgba(20, 20, 20, 0.6);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border: 1px solid rgba(212, 175, 55, 0.2);
      border-radius: 24px;
      padding: 18px 16px;
      margin-bottom: 16px;
      box-shadow: 0 10px 20px -10px black;
    }

    .card-title {
      font-size: 1rem;
      font-weight: 500;
      color: #d4af37;
      margin-bottom: 14px;
      letter-spacing: 0.3px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .grid-2 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }

    .stat {
      background: rgba(0, 0, 0, 0.4);
      border-radius: 18px;
      padding: 14px 12px;
      border-left: 3px solid #d4af37;
    }
    .stat-label {
      font-size: 0.75rem;
      color: #aaa;
      text-transform: uppercase;
      letter-spacing: 0.4px;
    }
    .stat-value {
      font-size: 1.5rem;
      font-weight: 600;
      color: white;
      line-height: 1.2;
    }
    .stat-sub {
      font-size: 0.8rem;
      color: #6b8e4c;
    }

    .badge {
      background: #6b8e4c20;
      border: 1px solid #6b8e4c;
      color: #b7d99e;
      padding: 4px 8px;
      border-radius: 40px;
      font-size: 0.7rem;
    }

    .batch-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid #2a2a2a;
    }
    .batch-row:last-child { border: none; }
    .batch-info h4 { font-size: 1rem; font-weight: 500; }
    .batch-info p { font-size: 0.75rem; color: #aaa; }
    .batch-numbers { text-align: right; }
    .batch-numbers .quantity { color: #d4af37; font-weight: 600; }

    .btn-gold {
      background: #d4af3720;
      border: 1px solid #d4af37;
      color: #d4af37;
      border-radius: 40px;
      padding: 10px 18px;
      font-weight: 500;
      font-size: 0.9rem;
      width: fit-content;
      backdrop-filter: blur(4px);
      transition: 0.2s;
      cursor: pointer;
    }
    .btn-gold i { margin-right: 6px; }
    .btn-gold:active { background: #d4af3740; }

    .chart-bar {
      background: #2b2b2b;
      height: 8px;
      border-radius: 20px;
      margin: 8px 0;
    }
    .bar-fill {
      height: 8px;
      background: linear-gradient(90deg, #d4af37, #f5e085);
      border-radius: 20px;
      width: 0%;
    }

    .tab-pane { display: none; }
    .tab-pane.active { display: block; }

    .gold-text { color: #d4af37; }
    .green-text { color: #6b8e4c; }
    hr { border: 0.5px solid #2a2a2a; margin: 16px 0; }

    .cost-item { display: flex; justify-content: space-between; margin: 12px 0; font-size: 0.95rem; }

    /* new BI styles */
    .input-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .input-row label {
      font-size: 0.85rem;
      color: #ccc;
    }
    .input-row input {
      background: #2a2a2a;
      border: 1px solid #3a3a3a;
      border-radius: 20px;
      padding: 8px 12px;
      width: 110px;
      color: white;
      font-size: 0.9rem;
      text-align: right;
    }
    .input-row input:focus {
      outline: 1px solid #d4af37;
    }
    .slider-row {
      display: flex;
      gap: 10px;
      align-items: center;
    }
    .slider-row input[type=range] {
      flex: 1;
      height: 6px;
      background: #2b2b2b;
      border-radius: 10px;
      -webkit-appearance: none;
    }
    .slider-row input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      background: #d4af37;
      border-radius: 50%;
      cursor: pointer;
    }
    .highlight {
      background: rgba(212, 175, 55, 0.15);
      padding: 8px 12px;
      border-radius: 16px;
      border-left: 3px solid #d4af37;
      margin-top: 12px;
    }
  </style>
</head>
<body>
<div id="app">
  <!-- header -->
  <div class="header">
    <h1>üêî POULTRY</h1>
    <i class="fas fa-qrcode"></i>
  </div>

  <!-- main content area: tab panes -->
  <div class="main-content" id="mainContent">
    <!-- DASHBOARD PANE (existing + new summary card) -->
    <div class="tab-pane active" id="dashboardPane">
      <div class="card">
        <div class="card-title"><i class="fas fa-eye gold-text"></i> live overview</div>
        <div class="grid-2">
          <div class="stat"><span class="stat-label">chickens</span><div class="stat-value">2,450</div><span class="stat-sub">+200 today</span></div>
          <div class="stat"><span class="stat-label">sold today</span><div class="stat-value">128</div><span class="stat-sub">$896</span></div>
          <div class="stat"><span class="stat-label">lost</span><div class="stat-value">12</div><span class="stat-sub">‚¨áÔ∏è 0.5%</span></div>
          <div class="stat"><span class="stat-label">revenue today</span><div class="stat-value">$1,280</div><span class="stat-sub">+18%</span></div>
        </div>
        <div style="margin-top: 16px;">
          <div style="display: flex; justify-content: space-between;"><span>üìÜ monthly revenue</span> <strong class="gold-text">$38,400</strong></div>
          <div class="chart-bar" style="margin:6px 0 12px;"><div class="bar-fill" style="width:76%"></div></div>
          <div style="display: flex; justify-content: space-between;"><span>üêî remaining stock</span> <strong>2,322</strong></div>
          <div style="display: flex; justify-content: space-between;"><span>üì¶ upcoming batch</span> <strong>650 (in 4d)</strong></div>
          <hr>
          <div style="display: flex; justify-content: space-between; font-size: 1.1rem;"><span>üìà profit est.</span> <strong class="green-text" id="dashboardProfit">$11,230</strong></div>
        </div>
      </div>
      <div class="card">
        <div class="card-title"><i class="fas fa-chart-line gold-text"></i> weekly trend</div>
        <div style="display: flex; gap: 10px; justify-content: space-between;">
          <span>M</span><span>T</span><span>W</span><span>T</span><span>F</span><span>S</span><span>S</span>
        </div>
        <div style="display: flex; gap: 8px; margin-top: 6px;">
          <div style="height: 40px; width: 12%; background: #d4af37; border-radius: 12px;"></div>
          <div style="height: 30px; width: 12%; background: #d4af37; border-radius: 12px;"></div>
          <div style="height: 50px; width: 12%; background: #d4af37; border-radius: 12px;"></div>
          <div style="height: 36px; width: 12%; background: #d4af37; border-radius: 12px;"></div>
          <div style="height: 60px; width: 12%; background: #d4af37; border-radius: 12px;"></div>
          <div style="height: 44px; width: 12%; background: #d4af37; border-radius: 12px;"></div>
          <div style="height: 38px; width: 12%; background: #aaa; border-radius: 12px;"></div>
        </div>
        <p class="badge" style="margin-top: 12px;"><i class="fas-regular fa-truck"></i> expansion: new farm in Q3</p>
      </div>

      <!-- NEW: BI snapshot card on dashboard -->
      <div class="card">
        <div class="card-title"><i class="fas fa-chart-simple gold-text"></i> profit snapshot</div>
        <div class="grid-2">
          <div><span class="stat-label">net profit</span><div class="stat-value" id="dashNetProfit">$15,000</div></div>
          <div><span class="stat-label">profit/bird</span><div class="stat-value" id="dashProfitPerBird">$4.21</div></div>
          <div><span class="stat-label">3‚Äëmo projection</span><div class="stat-value" id="dashProjection">$45k</div></div>
          <div><span class="stat-label">next target</span><div class="stat-value" id="dashTarget">R30k</div></div>
        </div>
      </div>
    </div>

    <!-- INVENTORY PANE (unchanged) -->
    <div class="tab-pane" id="inventoryPane"> ... </div>
    <!-- SALES PANE (unchanged) -->
    <div class="tab-pane" id="salesPane"> ... </div>
    <!-- LOGISTICS PANE (unchanged) -->
    <div class="tab-pane" id="logisticsPane"> ... </div>

    <!-- BUDGET PANE ‚Äî now with all BI modules (added after original content) -->
    <div class="tab-pane" id="budgetPane">
      <!-- original P&L card (kept) -->
      <div class="card">
        <div class="card-title"><i class="fas fa-coins gold-text"></i> P&L summary</div>
        <div class="cost-item"><span>üêî chicken cost</span> <span>$21,400</span></div>
        <div class="cost-item"><span>üåæ feed cost</span> <span>$11,200</span></div>
        <div class="cost-item"><span>üöö logistics</span> <span>$4,300</span></div>
        <div class="cost-item"><span>üë©‚Äçüåæ labor</span> <span>$6,500</span></div>
        <div class="cost-item" style="border-top:1px solid #333; margin-top:8px; padding-top:8px;">
          <span class="gold-text">üí∞ revenue</span> <span>$58,200</span>
        </div>
        <div class="cost-item"><span>üìà profit margin</span> <span class="green-text">26% ($15,000)</span></div>
      </div>
      <!-- original optimization card -->
      <div class="card">
        <div class="card-title">‚ö° optimization suggestions</div>
        <ul style="margin-left:20px; color:#ccc;">
          <li>üêî batch B2402 has lowest mortality ‚Äì replicate conditions</li>
          <li>üöõ combine city deliveries to save 12% fuel</li>
          <li>üåæ buy feed before April price hike</li>
        </ul>
      </div>

      <!-- ========== NEW BUSINESS INTELLIGENCE MODULES ========== -->
      <!-- MODULE 1 & 2: Cost Tracker + Sales Tracker (combined) -->
      <div class="card">
        <div class="card-title"><i class="fas fa-calculator gold-text"></i> monthly cost & revenue input</div>
        <div class="grid-2" style="gap: 16px;">
          <!-- left: costs -->
          <div>
            <p class="stat-label" style="margin-bottom:8px;">üí∞ expenses</p>
            <div class="input-row"><label>chicks purchased</label> <input type="number" id="chicksCost" value="5200" step="100"></div>
            <div class="input-row"><label>feed cost</label> <input type="number" id="feedCost" value="11200" step="100"></div>
            <div class="input-row"><label>transport</label> <input type="number" id="transportCost" value="4300" step="100"></div>
            <div class="input-row"><label>labor</label> <input type="number" id="laborCost" value="6500" step="100"></div>
            <div class="input-row"><label>utilities</label> <input type="number" id="utilitiesCost" value="1800" step="50"></div>
            <div class="input-row"><label>equipment</label> <input type="number" id="equipmentCost" value="900" step="50"></div>
            <div class="input-row"><label>death loss ($)</label> <input type="number" id="deathCost" value="840" step="20"></div>
            <hr style="margin:8px 0;">
            <div class="cost-item"><span>total cost</span> <span id="totalCost">30440</span></div>
          </div>
          <!-- right: revenue -->
          <div>
            <p class="stat-label" style="margin-bottom:8px;">üì¶ revenue streams</p>
            <div class="input-row"><label>live chickens</label> <input type="number" id="revLive" value="32000" step="500"></div>
            <div class="input-row"><label>prepared</label> <input type="number" id="revPrepared" value="8900" step="100"></div>
            <div class="input-row"><label>bulk</label> <input type="number" id="revBulk" value="12400" step="200"></div>
            <div class="input-row"><label>subscriptions</label> <input type="number" id="revSub" value="2800" step="100"></div>
            <div class="input-row"><label>by-products</label> <input type="number" id="revByproduct" value="1100" step="50"></div>
            <div class="input-row"><label>manure</label> <input type="number" id="revManure" value="600" step="50"></div>
            <div class="input-row"><label>other income</label> <input type="number" id="revOther" value="400" step="50"></div>
            <hr style="margin:8px 0;">
            <div class="cost-item"><span>total revenue</span> <span id="totalRevenue">58200</span></div>
          </div>
        </div>
        <!-- cost per chicken & revenue per chicken -->
        <div class="grid-2" style="margin-top:12px;">
          <div class="stat"><span class="stat-label">cost / chicken</span><div class="stat-value" id="costPerBird">8.74</div></div>
          <div class="stat"><span class="stat-label">revenue / chicken</span><div class="stat-value" id="revenuePerBird">16.72</div></div>
        </div>
      </div>

      <!-- MODULE 3: Net Profit Engine -->
      <div class="card">
        <div class="card-title"><i class="fas fa-chart-line gold-text"></i> net profit</div>
        <div style="display: flex; justify-content: space-between; align-items: baseline;">
          <span class="stat-label">monthly net profit</span>
          <span class="stat-value" id="netProfit">27760</span>
        </div>
        <div style="display: flex; justify-content: space-between;">
          <span>profit per chicken</span> <strong id="profitPerBird">7.98</strong>
        </div>
        <div class="badge" style="margin-top:8px;" id="profitTrend">üìà +8% vs last month</div>
      </div>

      <!-- MODULE 4: 3-Month Projection + growth simulator -->
      <div class="card">
        <div class="card-title"><i class="fas fa-chart-line gold-text"></i> 3‚Äëmonth profit projection</div>
        <div class="slider-row">
          <span style="font-size:0.8rem;">+0%</span>
          <input type="range" id="growthSlider" min="0" max="50" value="10" step="5">
          <span style="font-size:0.8rem;">+50%</span>
        </div>
        <p style="text-align:center;">revenue growth: <span id="growthPercent">10</span>%</p>
        <div class="highlight">
          <span>projected profit (3 months)</span>
          <strong style="float:right;" id="projectedProfit">91548</strong>
        </div>
        <p class="badge" style="margin-top:6px;">current profit √ó 3 + growth effect</p>
      </div>

      <!-- MODULE 5: Growth Checkpoint System -->
      <div class="card">
        <div class="card-title"><i class="fas fa-flag-checkered gold-text"></i> growth checkpoint</div>
        <div>current profit: <strong class="gold-text" id="currentProfitCheck">$27,760</strong></div>
        <div>next target: <strong>R30,000</strong> <span style="color:#6b8e4c;" id="gapToTarget">($2,240 to go)</span></div>
        <div class="chart-bar" style="margin:10px 0;"><div class="bar-fill" id="targetFill" style="width:92.5%"></div></div>
        <div style="font-size:0.85rem;">üí° suggestions: <span id="checkpointAdvice">increase bulk sales or reduce feed waste</span></div>
      </div>

      <!-- MODULE 6: Efficiency Monitor -->
      <div class="card">
        <div class="card-title"><i class="fas fa-gauge-high gold-text"></i> efficiency monitor</div>
        <div class="grid-2">
          <div><span class="stat-label">feed / chicken</span><div class="stat-value" id="feedPerBird">4.6</div><span class="stat-sub">kg</span></div>
          <div><span class="stat-label">death rate</span><div class="stat-value" id="deathRate">1.2</div><span class="stat-sub">%</span></div>
          <div><span class="stat-label">labor / chicken</span><div class="stat-value" id="laborPerBird">1.87</div><span class="stat-sub">$</span></div>
          <div><span class="stat-label">profit/worker</span><div class="stat-value" id="profitPerWorker">6930</div><span class="stat-sub">$</span></div>
        </div>
        <p class="badge" id="efficiencyWarn" style="margin-top:8px;">‚ö†Ô∏è feed usage high (above 4.2kg)</p>
      </div>

      <!-- MODULE 7: Expansion Trigger Engine -->
      <div class="card">
        <div class="card-title"><i class="fas fa-rocket gold-text"></i> expansion readiness</div>
        <div id="expansionMsg">‚úÖ profit ‚â• R40k? Not yet ‚Äî need +44% to unlock delivery vehicle</div>
        <div style="margin-top:8px;"><span class="stat-label">custom trigger</span> 
          <select id="triggerSelect" style="background:#2a2a2a; color:white; border:1px solid #d4af37; border-radius:20px; padding:6px;">
            <option value="40000">üöö delivery vehicle @ 40k</option>
            <option value="60000">üì¶ stock expansion @ 60k</option>
          </select>
        </div>
        <div class="badge" id="triggerStatus">trigger not met</div>
      </div>
    </div>

    <!-- SETTINGS PANE (unchanged) -->
    <div class="tab-pane" id="settingsPane"> ... </div>
  </div>

  <!-- bottom navigation (unchanged) -->
  <div class="bottom-nav">
    <div class="nav-item active" data-tab="dashboard"><i class="fas fa-chart-pie"></i><span>Home</span></div>
    <div class="nav-item" data-tab="inventory"><i class="fas fa-egg"></i><span>Stock</span></div>
    <div class="nav-item" data-tab="sales"><i class="fas fa-cash-register"></i><span>Sales</span></div>
    <div class="nav-item" data-tab="logistics"><i class="fas fa-truck"></i><span>Logistics</span></div>
    <div class="nav-item" data-tab="budget"><i class="fas fa-chart-line"></i><span>Budget</span></div>
    <div class="nav-item" data-tab="settings"><i class="fas fa-gear"></i><span>Settings</span></div>
  </div>
</div>

<script>
  (function() {
    // ---------- TAB SWITCHING (preserved) ----------
    const navItems = document.querySelectorAll('.nav-item');
    const panes = {
      dashboard: document.getElementById('dashboardPane'),
      inventory: document.getElementById('inventoryPane'),
      sales: document.getElementById('salesPane'),
      logistics: document.getElementById('logisticsPane'),
      budget: document.getElementById('budgetPane'),
      settings: document.getElementById('settingsPane')
    };
    function setActiveTab(tabId) {
      navItems.forEach(item => item.classList.remove('active'));
      Object.values(panes).forEach(pane => pane.classList.remove('active'));
      const activeNav = Array.from(navItems).find(item => item.dataset.tab === tabId);
      if (activeNav) activeNav.classList.add('active');
      if (panes[tabId]) panes[tabId].classList.add('active');
    }
    navItems.forEach(item => {
      item.addEventListener('click', (e) => { setActiveTab(item.dataset.tab); });
    });

    // ---------- B.I. ENGINE ----------
    // Helper to get numeric inputs
    function getVal(id) { return parseFloat(document.getElementById(id).value) || 0; }

    function updateBI() {
      // costs
      const chicks = getVal('chicksCost');
      const feed = getVal('feedCost');
      const transport = getVal('transportCost');
      const labor = getVal('laborCost');
      const utilities = getVal('utilitiesCost');
      const equip = getVal('equipmentCost');
      const deathLoss = getVal('deathCost');
      const totalCost = chicks+feed+transport+labor+utilities+equip+deathLoss;

      // revenues
      const revLive = getVal('revLive');
      const revPrep = getVal('revPrepared');
      const revBulk = getVal('revBulk');
      const revSub = getVal('revSub');
      const revBy = getVal('revByproduct');
      const revMan = getVal('revManure');
      const revOther = getVal('revOther');
      const totalRevenue = revLive+revPrep+revBulk+revSub+revBy+revMan+revOther;

      // chickens sold (from live+prepared+bulk approx, but we'll use a proxy: assume total chickens sold = 3480 based on revenue/price ~7.5)
      // better: derive from existing inventory numbers? we keep a fixed placeholder or let user input? Use mock: 3480 birds sold.
      const chickensSold = 3480; // from earlier P&L revenue ~58k / 16.7 ‚âà 3480
      const costPerBird = (totalCost / chickensSold).toFixed(2);
      const revenuePerBird = (totalRevenue / chickensSold).toFixed(2);
      const netProfit = totalRevenue - totalCost;
      const profitPerBird = (netProfit / chickensSold).toFixed(2);

      // update DOM
      document.getElementById('totalCost').innerText = totalCost.toFixed(0);
      document.getElementById('totalRevenue').innerText = totalRevenue.toFixed(0);
      document.getElementById('costPerBird').innerText = costPerBird;
      document.getElementById('revenuePerBird').innerText = revenuePerBird;
      document.getElementById('netProfit').innerText = netProfit.toFixed(0);
      document.getElementById('profitPerBird').innerText = profitPerBird;
      document.getElementById('dashNetProfit').innerText = '$' + (netProfit/1000).toFixed(1)+'k';
      document.getElementById('dashProfitPerBird').innerText = '$'+profitPerBird;
      document.getElementById('dashboardProfit').innerText = '$'+ (netProfit/1000).toFixed(1)+'k';

      // projection with growth slider
      const growth = getVal('growthSlider') / 100;
      document.getElementById('growthPercent').innerText = getVal('growthSlider');
      const projected = netProfit * 3 * (1 + growth);
      document.getElementById('projectedProfit').innerText = projected.toFixed(0);
      document.getElementById('dashProjection').innerText = '$' + (projected/1000).toFixed(0)+'k';

      // growth checkpoint (target R30k)
      const target = 30000;
      const gap = target - netProfit;
      document.getElementById('gapToTarget').innerText = gap > 0 ? `($${gap.toFixed(0)} to go)` : '(target exceeded)';
      let fillPercent = Math.min(100, (netProfit/target)*100);
      document.getElementById('targetFill').style.width = fillPercent+'%';
      let advice = netProfit < 20000 ? 'reduce mortality, renegotiate feed' : (netProfit < 30000 ? 'increase bulk sales or add subscription' : 'consider expansion');
      document.getElementById('checkpointAdvice').innerText = advice;
      document.getElementById('dashTarget').innerText = netProfit >= target ? 'R30k reached' : 'R30k';

      // efficiency monitor (using some derived values)
      const feedKgPerBird = (feed / 400).toFixed(1); // assuming 400 birds? rough
      document.getElementById('feedPerBird').innerText = feedKgPerBird;
      const deathRate = ( (getVal('deathCost')/7) / chickensSold * 100 ).toFixed(1);
      document.getElementById('deathRate').innerText = deathRate;
      const laborPerBird = (labor / chickensSold).toFixed(2);
      document.getElementById('laborPerBird').innerText = laborPerBird;
      const workers = 4; // assume 4 workers
      document.getElementById('profitPerWorker').innerText = (netProfit/workers).toFixed(0);
      let warn = (feedKgPerBird > 4.2) ? '‚ö†Ô∏è feed usage high (above 4.2kg)' : '‚úÖ feed efficiency OK';
      document.getElementById('efficiencyWarn').innerText = warn;

      // expansion trigger
      const triggerVal = parseInt(document.getElementById('triggerSelect').value);
      const met = netProfit >= triggerVal;
      document.getElementById('triggerStatus').innerText = met ? '‚úÖ trigger met! ready to expand' : '‚ùå threshold not reached';
      let expMsg = met ? 'üéâ You can now unlock: ' + (triggerVal==40000?'delivery vehicle':'stock expansion') 
                       : `üí∏ need $${(triggerVal-netProfit).toFixed(0)} more to unlock.`;
      document.getElementById('expansionMsg').innerHTML = expMsg;

      // profit trend (mock)
      document.getElementById('profitTrend').innerText = netProfit > 27000 ? 'üìà +12% vs last month' : 'üìä stable vs last month';
    }

    // attach listeners to all inputs
    const inputIds = ['chicksCost','feedCost','transportCost','laborCost','utilitiesCost','equipmentCost','deathCost',
      'revLive','revPrepared','revBulk','revSub','revByproduct','revManure','revOther','growthSlider','triggerSelect'];
    inputIds.forEach(id => {
      const el = document.getElementById(id);
      if (el) el.addEventListener('input', updateBI);
    });

    // initial update
    updateBI();

    // preserve original button alerts
    const btns = document.querySelectorAll('.btn-gold');
    btns.forEach(btn => {
      btn.addEventListener('click', (e) => {
        if (btn.innerText.includes('register') || btn.innerText.includes('add') || btn.innerText.includes('assign')) {
          e.preventDefault();
          alert('‚ú® This would open a form. Data would be saved to Supabase (backend ready).');
        }
      });
    });

    console.log('BI-enhanced dashboard running');
  })();
</script>
<!-- backend ready note (unchanged) -->
</body>
</html>